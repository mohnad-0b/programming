from Crypto.Cipher import AES
from Crypto.PublicKey import RSA
from Crypto.Util.number import long_to_bytes


flag_enc1 = open('flag.txt.aes', 'rb').read()
c = open('key', 'r').read()

rsa = RSA.importKey(open('pubkey.pem', 'r').read())
n = rsa.n #http://factordb.com/index.php?query=1128137999850045612492145429133282716267233566834715456536184965477269592934207986950131365518741418540788596074115883774105736493742449131477464976858161587355643311888741515506653603321337485523828144179637379528510277430032789458804637543905426347328041281785616616421292879871785633181756858096548411753919440011378411476275900648915887370219369154688926914542233244450724820670256654513052812215949495598592852131398736567134556141744727764716053145639513031
e = rsa.e
p = 10410080216253956216713537817182443360779235033823514652866757961082890116671874771565125457104853470727423173827404139905383330210096904014560996952285911
phi = (p)*(p)*(p-1)
d = pow(e, -1, phi)
key = long_to_bytes(pow(int(c,16),d, n))

# print(key)
cipher = AES.new(key, AES.MODE_ECB)
flag = cipher.decrypt(flag_enc1[:-1]) # use [:-1] to remove newline character
print(flag)
