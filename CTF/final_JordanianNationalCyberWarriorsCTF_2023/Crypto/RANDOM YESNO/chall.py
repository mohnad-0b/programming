from Crypto.Util.number import bytes_to_long
from Crypto.Util.number import getPrime
import random

def generate_strong_modulus():
	p = getPrime(2048)
	q = getPrime(2048)
	n = p * q
	return n,p,q

def encrypt_message(message, n, p, q):
	r1 = random.getrandbits(512)
	r2 = random.getrandbits(512)
	r3 = random.getrandbits(512)
	r4 = random.getrandbits(512)
	r5 = random.getrandbits(512)
	r6 = pow(r1, r2*(p-1), n)
	r7 = pow(r1, r3*(q-1), n)
	c1 = bytes_to_long(message) * pow(r6,r4,n) % n
	c2 = bytes_to_long(message) * pow(r7,r5,n) % n
	return r4,r5,r6,r7,c1,c2

n,p,q = generate_strong_modulus()
FLAG = "FLAG{THIS_IS_FLAG}"
r4,r5,r6,r7,c1,c2 = encrypt_message(FLAG,n,p,q)
print(f"N: {n}")
print(f"Outputs: \nr4:{r4} \nr5:{r5}\nr6:{r6} \nr7:{r7} \nc1:{c1} \nc2:{c2}")
# N: 628416018012795466001562881783178480533822946117843863095140480595157145452679543266328369025965261080429163584329920034437331760913494132371236637829155987371195947650699764550033346149145678530512663942806711774683892529200620732838653700658871046245309363401016172461522377544666773437634344205390994801073508357215374122205830415540292507662282506473188220415195094547013464295468016716927958820081054965401036856466911010323034541543362881831472261641620685778495915023354635766293065960798324514905542913257288029527349968874933272627450773384163013756191523458361185437675488225947846547700696367646817405584219921864621408035496666300925728442441713092578469276202358926432913754419720936568704018435649814753933704006076257936966281426185653526498077339551211378733304477446215919843120098230590735772169389766674377757044724638455182058388356383067124007172165206561435953861731044301721178818355249162110495357539825369041780154081028763647504472673569747804039853963541670036517290427472909892808883452687482966422813444213111048934950939801185921349600441021540703343627019302022835060263174507902409876176812420230099281012697413844855411071323779861105703864357477683307718064683958814708953767376386027316943998152873
# Outputs:
# r4:5993171080807012477512737985469145912372457940523717257265921819028721474605213282097673035656315735832713436263667240403126438155182122766853783715797985
# r5:12481190256876183092919639155557285807653736529844976123958004810366927585284660953171773281375901623528022508151875705353099130343404937638249495289744556
# r6:528734634468120007676347064464973611782808066480504203451587217117955172585322772479079191041575271081718386976338577762578190573325001224891804307715306174240480542751191499528395562588708947038138075919276668840906334229980934943287034557864863113807599005925867178682115630370844242272768528740082461412689225333843636332119569740959257492464709783807777435567368414601793765415313220184365103896871416886464673413880352585378988445006539958118645224804535189337100279700397572821415271529277673252072137704499593158821570942781068945864603908855590782843808392476250938936385372956425835477019129959976581864504557887055410456045110876539811895437542883185057348070544194453350162284355999922987724728896279912153893155621369020908841987562261735905355960981980118561209559854858515304459132951706850234349577985690361168672349499484613155234263445306282054373632889881174719832474722141426553042703214124402744016200866936651034304701878686744760531975313930778760955706934816232164214838137513468921389853412051189524428569981908138918092633555419366345024195769618348859397918123736331452010642229512398926000231781407209422756452634842750567498550757013740795762282607026087913124056398232236932324654999937116594142017098382
# r7:367206554118785509066474229440403712483477187394243919960211442045535647240989905631399758151788917226339191299323046022353698056230850596252605296766665939530420108092705692685850698979898350803347833045007976239851641383062360455606732634762477531410408056462968098077121586710234847183547593564870044718025589935319066335360614397197055745024536567902685547499158390676347302014541751170817346048716619864178041511223104237175082849753552217103286952725003841042357205655464179530899206979709641401176709946408089522421759425762996824093271170609732280282256833794969246298979713962565541938300851507913525815806003354079773770185396904581200294857368837837777952681095281037721331750103874318826969760239197929743492248480662433110033896910075941586557905313851733179931848655640776064338823212797785528013808839048114461220229273415679076585519512323330850854837889424896706497802950188166675035127474820690513196139333203234810963016325958909323827749086871851841305626993672032534436214108436889168861908164370656589295016660647004497011367600235634587170787556026980068926016545443585957823478270346130777009349043028432756384888818865920791511448651137647038242255392807374263642771339946467357399768416104478757514165792669
# c1:611173584981031512636514144777710182505305670734241001359287909182617743560676470756499430141824985480882472432126406977480109802863516183764330607158848969406976422279866370289948474356564195433326415656466982363878635493485406276186636345612149343125480877573321367754948510861515854378448082299943236809832054323772549991708793824564405301988478357013290626414388670355346846647144875600490121436108844216157030350367650336073584801368647523344493248261814451362076439455821638615557212455139394727733512371039516158916234029037512008896426793781852417224409548898045898040419453017910054350735770471019474103846505524028590067858752961192647213132477151567277650335456380539950415785725369526631223871742502151380762405398284364195524441682988595985631029378095403467117584458101245676074438209182723914975701402377181735824245291449702202323985601406373436755561039766280921299209605001438020446756486807401784178594702584258713093171346908613743806460229273856598879961888175646307011977966726005224112464828517357093207728088759699896622907094179342149636512116650342892550110512558904416578885698180653904112738160266031838238544657096500150182665462799153517362430849611501605424527692635430445888039001937194328953084415917
# c2:543316223851059006432606957680845064722790289851597360299757276344584725857584402474626906161200731451761347798606078346700242370137636291410609309424702136564151149283717409357318742833246609468842179836266019387487306082562865164538034042068217418837001924317392404105092160197714845577634173755279974024748778792451645801159742732412247046457189918583355493791176891176586055818870335603199555029802265922420791882179199567020268071222808418965182785349238283705928820944427610047875331623770055552737092766496324823326871075674756016924502110208059467979293694215046395443183056443999381579319722645510490270720194685891180145927653236247376770466712275221853411132952742891256144259721088280182129233096925708305220796945319851469439509517401580656294690612013085474566203566565160905611199801957972668421289991701337471112814875242609697814344281749133976198444351581741913767503670513818134521871885184104852292220000434025738318172045763222924606373409668524538157931637723002191202324937125465399315501349813576811443062749442524799088300991555460002082127136122354311252408537216300056528953800829036509304110441666602833718172613789794522881011512483821447704858002272463531473292937169700899344548363021549944670352320758

